/* 2017-01-21 */$(function(){var a=lib.flexible.dpr,b=0,c=1;new Spinner({color:"#fff",width:3*a,radius:11*a,length:8*a}).spin(document.getElementById("preview"));var d=function(){100==c&&(clearInterval(e),$(".loading-content").addClass("opacity"),$(".index-content").show(),setTimeout(function(){$(".loading-content").hide()},2e3)),b+=.06,$(".loading-animation").animate({width:b+"rem"},35),$(".loading-number").html(c+"%"),c++},e=setInterval(d,50);$(".rule").click(function(){$(".popup-rule").show(),$(".rule").hide()}),$(".overlay, .close, .know").click(function(){$(".popup").hide(),$(".popup-rule").hide(),$(".rule").show()}),$("button").click(function(){var a=$("input[type='name']").val().replace(/(^\s*)|(\s*$)/g,"").replace(/\s+/g,""),b=$("input[type='tel']").val().replace(/(^\s*)|(\s*$)/g,""),c="",d=0;return""===a?($(".error").html("请输入您的姓名!"),$(".popup").show(),!1):/^[\u4e00-\u9fa5 ]{2,8}$/.test(a)?""===b?($(".error").html("请输入您的手机号码!"),$(".popup").show(),!1):/^1[34578]\d{9}$/.test(b)?void $.ajax({type:"POST",url:"identity.php",data:{username:a,phone:b},dataType:"json",beforeSend:function(){$(".popup-spin").show()},complete:function(){$(".popup-spin").hide()},success:function(a){if(0!==a.status)return $(".error").html("该手机号已经领过奖了！"),$(".popup").show(),!1;switch($(".index-content").addClass("out"),$(".luckdraw-content").show(),setTimeout(function(){$(".luckdraw-content").addClass("in"),$(".index-content").hide()},600),a.data.prize){case 1e3:c="二",d=2e3;break;case 158:c="三",d=36300;break;case 88:c="四",d=48e3;break;case 58:c="五",d=9600}$(".reward").html("恭喜"+b+"<br>获得"+c+"等奖"),$(".people-number").html(d),$(".red-number").html(a.data.prize),$("#shop-information").citySelect({prov:a.data.origin.region,city:a.data.origin.city,flag:2})},error:function(){return $(".error").html("服务器繁忙，请稍候重试！"),$(".popup").show(),!1}}):($(".error").html("请正确输入手机号码!"),$(".popup").show(),!1):($(".error").html("请正确输入您的姓名!"),$(".popup").show(),!1)}),$("i").click(function(){$(this).addClass("scale"),setTimeout(function(){$(".luckdraw-content").removeClass("in"),$(".luckdraw-content").addClass("out"),$(".lookreward-content").show()},500),setTimeout(function(){$(".lookreward-content").addClass("in"),$(".luckdraw-content").hide()},1100),setTimeout(function(){window.flag_default&&$(".popup").show()},1900)}),$("#shop-information").citySelect({flag:1})});