{"version":3,"sources":["src\\js\\pages\\activity\\treasure\\index.js"],"names":["Treasure","props","document","title","state","clsName","login","indianaNumber","indiana","surplus","userRecord","winningRecord","fetchData","loading","then","hide","response","data","code","message","parseInt","info","setState","catch","e","preventDefault","html","alert","click","type","target","getAttribute","location","href","content","btnText","callback","popup","sendBet","bind","count","length","map","v","i","key","value","join","stage","btn","fetchTicket","__html","width","bet","ticketList","prizeList","onAll","Component"],"mappings":"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","file":"index.js","sourceRoot":"E:/MyStudy/Redux/app_four","sourcesContent":["import React from 'react'\r\nimport { Link } from 'react-router'\r\nimport {Toast} from 'antd-mobile'\r\nimport 'scss/activity/treasure.component.scss'\r\nimport Popup from '../components/Popup'\r\nimport {get, post, login, goHome, goCertification, resolveUrl} from 'utils'\r\n\r\nexport default class Treasure extends React.Component {\r\n  constructor (props) {\r\n    super(props)\r\n    document.title = '夺宝'\r\n    this.state = {\r\n      clsName: 'empty',\r\n      login: 0,\r\n      indianaNumber: 0,\r\n      indiana: '登录查看夺宝券',\r\n      surplus: 0,\r\n      userRecord: [],\r\n      winningRecord: []\r\n    }\r\n  }\r\n  componentDidMount () {\r\n    this.fetchData()\r\n  }\r\n\r\n  fetchData () {\r\n    Toast.loading('加载中...', 0)\r\n    get('http://credit.xianjincard.com/operate-activity/mother-entrance?tag=h5-19700101-motherDay').then(response => {\r\n      // console.log(response)\r\n      Toast.hide()\r\n      const {code, message, data} = response.data\r\n      if (parseInt(code) !== 0) {\r\n        Toast.info(message, 2)\r\n        return\r\n      }\r\n      this.setState({...data})\r\n    }).catch(response => {\r\n      Toast.hide()\r\n    })\r\n  }\r\n  fetchTicket (e) {\r\n    e.preventDefault()\r\n    if (!this.login()) {\r\n      return\r\n    }\r\n    let html = `\r\n      <div>\r\n        <h1></h1>\r\n        <div class=\"time\"><p>活动时间：5月11日10:00起</p></div>\r\n        <ul>\r\n          <li>\r\n            <div>\r\n              <h2>成功借款</h2>\r\n              <p>成功借款，获夺宝券1张</p>\r\n            </div>\r\n            <button data-type=\"0\">去借款</button>\r\n          </li>\r\n          <li>\r\n            <div>\r\n              <h2>分享邀请</h2>\r\n              <p>好友注册，每天最多获夺宝券10张</p>\r\n            </div>\r\n            <button data-type=\"1\">去邀请</button>\r\n          </li>\r\n          <li>\r\n            <div>\r\n              <h2>测试信用</h2>\r\n              <p>芝麻信用分认证，获夺宝券1张</p>\r\n            </div>\r\n            <button data-type=\"2\">去测试</button>\r\n          </li>\r\n        </ul>\r\n      </div>`\r\n    Popup.alert(html, 'treasure-fetch-ticket')\r\n    Popup.click('button', function (e) {\r\n      let type = parseInt(e.target.getAttribute('data-type'))\r\n      get('http://credit.xianjincard.com/operate-activity/mother-obtain', {type: type})\r\n\r\n      if (type === 0) {\r\n        goHome()\r\n        return\r\n      }\r\n      if (type === 1) {\r\n        location.href = resolveUrl('http://credit.xianjincard.com/credit-invite/invite-rebate-start?clientType=wap')\r\n        return\r\n      }\r\n      if (type === 2) {\r\n        goCertification()\r\n        return\r\n      }\r\n    })\r\n  }\r\n  popup (content, btnText, callback) {\r\n    Popup.alert(`<p>${content}</p><button>${btnText}</button>`, 'treasure-popup')\r\n    Popup.click('button', callback)\r\n  }\r\n  login () {\r\n    if (this.state.login === 1) {\r\n      return true\r\n    }\r\n    this.popup('您还没登录</br>无法参与夺宝，请先登录', '点击登录', login)\r\n  }\r\n  bet () {\r\n    if (this.login()) {\r\n      if (this.state.indianaNumber <= 0) {\r\n        this.popup('夺宝券为0</br>无法投注', '确定')\r\n        return\r\n      }\r\n      this.popup('本次投注将消耗1张夺宝券</br>参与后获得夺宝号</br>投注后不可更改</br>确定投注吗?', '确定投注', this.sendBet.bind(this))\r\n    }\r\n  }\r\n  sendBet () {\r\n    post('http://credit.xianjincard.com/operate-activity/betting').then(response => {\r\n      // console.log(response)\r\n      const {code, message, data} = response.data\r\n      if (code !== 0) {\r\n        Toast.info(message, 2)\r\n        return\r\n      }\r\n      this.setState({userRecord: data.userRecord, indianaNumber: data.count, surplus: data.surplus})\r\n      this.popup('恭喜你</br>投注成功</br>祝您好运', '朕知道了')\r\n    })\r\n  }\r\n  onAll (e) {\r\n    e.preventDefault()\r\n    this.setState({clsName: ''})\r\n  }\r\n  ticketList () {\r\n    const {userRecord} = this.state\r\n    if (userRecord.length <= 0) {\r\n      return <div>暂无数据</div>\r\n    }\r\n    return userRecord.map((v, i) => <li key={i}>第{v.key}期: {v.value.join(', ')}</li>)\r\n  }\r\n  prizeList () {\r\n    const {winningRecord} = this.state\r\n    if (winningRecord.length <= 0) {\r\n      return <li>暂无数据</li>\r\n    }\r\n    return winningRecord.map((v, i) => <li key={i}>{v}</li>)\r\n  }\r\n  render () {\r\n    const {login, indianaNumber, surplus, clsName, stage, winningRecord} = this.state\r\n    let btn = login === 0 ? '登录查看夺宝券' : `我的夺宝券(${indianaNumber})`\r\n    return (\r\n      <div class='activity-treasure'>\r\n        <div class='top'>\r\n          <button onClick={this.login.bind(this)}>{btn}</button>\r\n          <button onClick={this.fetchTicket.bind(this)}>获取夺宝券</button>\r\n        </div>\r\n        <h1 dangerouslySetInnerHTML={{__html: stage}} />\r\n        <h3>每期奖金<i>1000</i>元</h3>\r\n        <div class='progress'><div style={{width: `${(1000 - surplus) / 1000 * 100}%`}} /></div>\r\n        <div class='progress-info'>\r\n          <span>集齐1000份开奖哦</span>\r\n          <span>距开奖还差<i>{surplus}</i>份</span>\r\n        </div>\r\n        <button class='bet' onClick={this.bet.bind(this)}>我要投注</button>\r\n        <div class='ticket-list'>\r\n          <ul>\r\n            {this.ticketList()}\r\n          </ul>\r\n        </div>\r\n        <div class='prize-list'>\r\n          <span class='head' />\r\n          <div>\r\n            <h4>往期中奖结果</h4>\r\n            <ul class={clsName}>\r\n              {this.prizeList()}\r\n            </ul>\r\n            {winningRecord.length > 3 && clsName !== '' && <div class='bar'><a href='' onClick={this.onAll.bind(this)}>查看全部</a></div>}\r\n          </div>\r\n          <span class='bottom' />\r\n        </div>\r\n        <Link to='/activity/treasure/rule' class='rule' />\r\n      </div>\r\n    )\r\n  }\r\n}\r\n"]}