{"version":3,"sources":["src\\js\\pages\\cash-bonus\\index.js"],"names":["title","Item","Brief","defaultIcon","require","alert","CashBonus","props","state","money","total","segments","segmentIndex","items","cashs","loaded","document","then","response","data","balance","logs","cash","is_card","is_pwd","is_date_limit","is_overdue","setState","catch","middleware","bind","code","message","Toast","fail","value","index","indexOf","__html","undefined","text","onPress","window","location","encodeURIComponent","href","source","type","amount","icon","created_at","date","unix","format","history","segment","isActive","withdrawal","length","map","item"],"mappings":"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","file":"index.js","sourceRoot":"E:/MyStudy/Redux/app_four","sourcesContent":["/* eslint-disable */\r\nimport React, {Component} from 'react';\r\nimport {List, SegmentedControl, Modal} from 'antd-mobile';\r\nimport {resolveUrl, login, share} from 'utils';\r\nimport moment from 'moment';\r\nimport request from './request';\r\nimport 'scss/cash-bonus/index.component.scss';\r\n\r\nlet title = '现金红包';\r\nlet Item = List.Item;\r\nlet Brief = Item.Brief;\r\nlet defaultIcon = require('../../../assets/img/cash-bonus/icon.png');\r\nlet alert = Modal.alert;\r\n\r\nexport default class CashBonus extends Component{\r\n    constructor(props){\r\n        super(props);\r\n        this.state = {\r\n            money: 0,\r\n            total: 0,\r\n            segments: ['当前奖金', '提现历史'],\r\n            segmentIndex: 0,\r\n            items: [],\r\n            cashs: [],\r\n            loaded: 0\r\n        };\r\n    }\r\n    componentDidMount(){\r\n        document.title = title;\r\n        request('user-account/index').then(response => {\r\n            let {balance: money, total, logs: items, cash: cashs, is_card, is_pwd, is_date_limit, is_overdue} = response.data;\r\n            this.setState({\r\n                money: +money,\r\n                total,\r\n                items,\r\n                cashs,\r\n                is_card,\r\n                is_pwd,\r\n                loaded: 1\r\n            });\r\n        }).catch(this.middleware.bind(this));\r\n    }\r\n    middleware(response){\r\n        let {code, message} = response;\r\n        this.setState({\r\n            loaded: 1\r\n        });\r\n        if(-1001 === code){\r\n            login();\r\n            return;\r\n        }else{\r\n            Toast.fail(message, 1.5);\r\n        }\r\n    }\r\n    segment(value){\r\n        let {segments} = this.state;\r\n        let index = segments.indexOf(value);\r\n        if(index >= 0){\r\n            this.setState({\r\n                segmentIndex: index\r\n            });\r\n        }\r\n    }\r\n    isActive(index){\r\n        let {segmentIndex} = this.state;\r\n        return index === segmentIndex ? 'active' : '';\r\n    }\r\n    withdrawal(){\r\n        let {money, is_card, is_pwd, is_date_limit, is_overdue} = this.state;\r\n        let message = (message) => {\r\n            return (\r\n                <p className='tips' dangerouslySetInnerHTML={{__html: message}}></p>\r\n            )\r\n        };\r\n        if(is_card == 0){\r\n            alert(undefined, message('请先绑定银行卡再提现'), [{\r\n                text: '取消'\r\n            }, {\r\n                text: '去绑定',\r\n                onPress(){\r\n                    // todo 跳转到原生绑定银行卡\r\n                    window.location = resolveUrl('http://m.xianjincard.com/loan/card-list');\r\n                }\r\n            }]);\r\n            return;\r\n        }else if(is_pwd == 0){\r\n            alert(undefined, message('请先设置交易密码再提现'), [{\r\n                text: '取消'\r\n            }, {\r\n                text: '去设置',\r\n                onPress(){\r\n                    // todo 跳转到原生设置交易密码\r\n                    window.location = resolveUrl('http://h5.xianjincard.com/mobile/#/my/paypassword?state=' + encodeURIComponent(window.location.href));\r\n                }\r\n            }]);\r\n            return;\r\n        }else if(is_date_limit == 0){\r\n            alert(undefined, message('本周一次提现机会已经用完咯<br/>您下周再来吧'), [{\r\n                text: '确定'\r\n            }]);\r\n            return;\r\n        }else if(is_overdue == 0){\r\n            alert(undefined, message('您目前有订单处于预期中，请先还款后再提现'), [{\r\n                text: '确定'\r\n            }]);\r\n            return;\r\n        }else if(money < 30){\r\n            alert(undefined, message('您的提现额度不足30元<br/>不能提现'), [{\r\n                text: '确定'\r\n            }]);\r\n            return;\r\n        }else{\r\n            window.location.href = `cash-bonus/withdrawal?money=${money}`;\r\n        }\r\n    }\r\n    render(){\r\n        let {money, total, segments, segmentIndex, items, cashs, loaded} = this.state;\r\n        let source = (data, index) => {\r\n            let {title, type, amount: money, icon = defaultIcon, created_at} = data;\r\n            let date = moment.unix(created_at).format('YYYY-MM-DD HH:mm:ss');\r\n            return (\r\n                <Item\r\n                key={index}\r\n                multipleLine\r\n                extra={`+${money}`}\r\n                thumb={icon}>\r\n                    {title}\r\n                    <Brief>{date}</Brief>\r\n                </Item>\r\n            )\r\n        };\r\n        let history = (data, index) => {\r\n            let {title, type, amount: money, created_at} = data;\r\n            let date = moment.unix(created_at).format('YYYY-MM-DD HH:mm:ss');\r\n            return (\r\n                <Item\r\n                key={index}\r\n                multipleLine\r\n                extra={`+${money}`}>\r\n                    {title}\r\n                    <Brief>{date}</Brief>\r\n                </Item>\r\n            );\r\n        };\r\n        return (\r\n            <div className={`wrapper wrapper-cash-bonus ${loaded ? 'loaded' : ''}`}>\r\n                <SegmentedControl\r\n                className='segment'\r\n                onValueChange={this.segment.bind(this)}\r\n                selectedIndex={segmentIndex}\r\n                values={segments}/>\r\n                <div className='segment-content'>\r\n                    <div className={`home ${this.isActive.bind(this, 0)()}`}>\r\n                        <div className='main'>\r\n                            <div>\r\n                                当前可提现金额(元)\r\n                                <div className='money'>{money}</div>\r\n                                <div className='withdrawal' onClick={this.withdrawal.bind(this)}>立即提现</div>\r\n                                <div className='total'>历史获得金额：{total}元</div>\r\n                                <div className='help' onClick={() => {\r\n                                    window.location.href = '/cash-bonus/instruction';\r\n                                }}>什么是现金红包？</div>\r\n                            </div>\r\n                        </div>\r\n                        <List renderHeader={() => '奖励来源'}>\r\n                            <div className='content'>\r\n                            {\r\n                                items.length ? (\r\n                                    items.map((item, index) => source(item, index))\r\n                                ) : (\r\n                                    <div className='empty'>暂无数据</div>\r\n                                )\r\n                            }\r\n                            </div>\r\n                        </List>\r\n                        <List renderHeader={() => '提现说明'}>\r\n                            <ul className='description'>\r\n                                <li>每个周可申请一次现金提现；</li>\r\n                                <li>累计满30元才可以提现，且只能全额提取；</li>\r\n                                <li>处于逾期状态中的用户需先还款才可以提现</li>\r\n                                <li>申请成功后，奖金将在3个工作日内发放到您绑定的银行卡上;</li>\r\n                                <li>如遇法定节假日，提现进度顺延；</li>\r\n                                <li>如有问题请拨打客服热线<span>400－681－2016</span></li>\r\n                            </ul>\r\n                        </List>\r\n                    </div>\r\n                    <div className={`history ${this.isActive.bind(this, 1)()}`}>\r\n                        <List>\r\n                            <div className='content'>\r\n                            {\r\n                                cashs.length ? (\r\n                                    cashs.map((cash, index) => history(cash, index))\r\n                                ) : (\r\n                                    <div className='empty'>暂无数据</div>\r\n                                )\r\n                            }\r\n                            </div>\r\n                        </List>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n};"]}