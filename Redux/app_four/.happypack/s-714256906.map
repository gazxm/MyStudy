{"version":3,"sources":["src\\js\\pages\\activity\\seckill\\Ticket.js"],"names":["Ticket","props","state","ticket","className","restTime","nowTime","code","setState","nt","slice","startTime","start_time","interval","setInterval","nextProps","changeTicket","st","time","calcTime","amount","index","rob","hour","Math","floor","min","sec","length","text1","bind","text2","text3","footerL","footerR1","unit","name","footerR2","icon","total_amount","Component"],"mappings":"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","file":"Ticket.js","sourceRoot":"E:/MyStudy/Redux/app_four","sourcesContent":["import React from 'react'\r\n\r\nexport default class Ticket extends React.Component {\r\n  constructor (props) {\r\n    super(props)\r\n    this.state = {\r\n      ticket: {\r\n        ...this.props.ticket[0]\r\n      },\r\n      className: 'wait',\r\n      restTime: '00:00:00'\r\n    }\r\n  }\r\n\r\n  componentWillMount () {\r\n    let { nowTime, code } = this.props\r\n\r\n    if (code === -2013) {\r\n      this.setState({\r\n        className: 'end'\r\n      })\r\n      return\r\n    }\r\n\r\n    let nt = nowTime.slice(0, 2) * 60 * 60 + nowTime.slice(3, 5) * 60 + nowTime.slice(6, 8) * 1\r\n    let startTime = this.state.ticket.start_time.slice(0, 2) * 3600\r\n\r\n    this.interval(nt, startTime)\r\n    setInterval(() => {\r\n      this.interval(++nt, startTime)\r\n    }, 1000)\r\n  }\r\n\r\n  componentWillReceiveProps (nextProps) {\r\n    this.changeTicket(nextProps.ticket[0])\r\n  }\r\n\r\n  interval (nt, st) {\r\n    let time = st - nt\r\n    if (time > 0) {\r\n      this.setState({\r\n        restTime: this.calcTime(time)\r\n      })\r\n      return\r\n    }\r\n    if (time === 0) {\r\n      this.setState({\r\n        className: 'active'\r\n      })\r\n      return\r\n    }\r\n    if (time < 0 && this.state.ticket.amount > 0) {\r\n      this.setState({\r\n        className: 'active'\r\n      })\r\n      return\r\n    }\r\n    this.setState({\r\n      className: 'end'\r\n    })\r\n  }\r\n\r\n  changeTicket (ticket) {\r\n    const time = this.state.restTime.slice(0, 2) * 60 * 60 + this.state.restTime.slice(3, 5) * 60 + this.state.restTime.slice(6, 8) * 1\r\n    if (ticket.amount === 0 && time <= 1) {\r\n      this.setState({\r\n        ticket: {\r\n          ...ticket\r\n        },\r\n        className: 'end'\r\n      })\r\n      return\r\n    }\r\n    this.setState({\r\n      ticket: {\r\n        ...ticket\r\n      }\r\n    })\r\n  }\r\n\r\n  rob () {\r\n    const { index } = this.state.ticket\r\n    this.props.rob(index)\r\n  }\r\n\r\n  calcTime (time) {\r\n    let hour = Math.floor(time / 3600) + ''\r\n    let min = Math.floor((time - hour * 3600) / 60) + ''\r\n    let sec = (time - hour * 3600 - min * 60) + ''\r\n    if (hour.length === 1) {\r\n      hour = `0${hour}`\r\n    }\r\n    if (min.length === 1) {\r\n      min = `0${min}`\r\n    }\r\n    if (sec.length === 1) {\r\n      sec = `0${sec}`\r\n    }\r\n    return `${hour}:${min}:${sec}`\r\n  }\r\n\r\n  render () {\r\n    const { ticket, className, restTime } = this.state\r\n\r\n    const text1 = className === 'active' ? <a className='right' onClick={this.rob.bind(this)}><span>立即开抢</span></a> : null\r\n    const text2 = className === 'wait' ? <a className='right'><span>即将开抢</span></a> : null\r\n    const text3 = className === 'end' ? <a className='right'><span>已结束</span></a> : null\r\n\r\n    const footerL = className === 'end' ? <span><b>{ticket.start_time}</b>本次秒杀已结束</span> : <span><b>{ticket.start_time}</b></span>\r\n    const footerR1 = className === 'active' ? <p className='right'>还剩余{ticket.amount}{ticket.unit}{ticket.name}</p> : null\r\n    const footerR2 = className === 'wait' ? <p className='right'>距开始还有{restTime}</p> : null\r\n\r\n    return (\r\n      <div className={`ticket ${className}`}>\r\n        <div className='head clearfix'>\r\n          <p className='left'><img alt={ticket.name} src={ticket.icon} />{ticket.name}{ticket.total_amount}{ticket.unit}</p>\r\n          {text1}{text2}{text3}\r\n          <ul><li /><li /><li /><li /><li /><li /><li /><li /><li /><li /><li /><li /><li /><li /><li /><li /><li /><li /><li /><li /><li /><li /></ul>\r\n        </div>\r\n        <div className='footer clearfix'>\r\n          <div className='left'>\r\n            <i />\r\n            {footerL}\r\n          </div>\r\n          {footerR1}{footerR2}\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n"]}