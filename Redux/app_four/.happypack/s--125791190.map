{"version":3,"sources":["src\\js\\pages\\activity\\cash-gift\\index.js"],"names":["title","lock","Welcome","props","state","receive","apply","loaded","visible","prompt","interceptors","response","use","code","data","message","reject","resolve","document","then","flag","acted_flag","cash","coupons","coupon","indexOf","setState","middleware","catch","m","bind","hide","fail","loading","undefined","setTimeout","tag","location","query","isApp","window","href","wrapper","open","check","close","value","unit","length","map","index","start","end","login"],"mappings":"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","file":"index.js","sourceRoot":"E:/MyStudy/Redux/app_four","sourcesContent":["import React, {Component} from 'react';\r\nimport {Modal, Toast} from 'antd-mobile';\r\nimport request from './request';\r\nimport {resolveUrl, platform, login, share, hrefNative} from 'utils';\r\n\r\nimport classnames from 'classnames';\r\nimport 'scss/components/reboot.component.scss';\r\nimport 'scss/activity/cash-gift.component.scss';\r\n\r\nlet title = '现金大礼包';\r\nlet lock = true;\r\n\r\nexport default class Welcome extends Component{\r\n    constructor(props){\r\n        super(props);\r\n        this.state = {\r\n            receive: 0,\r\n            apply: 0,\r\n            loaded: 0,\r\n            visible: 0,\r\n            prompt: 0\r\n        };\r\n        // interceptors for response\r\n        request.interceptors.response.use(response => {\r\n            let {code, data, message} = response;\r\n            if(code !== 0){\r\n                return Promise.reject(response);\r\n            }\r\n            return Promise.resolve(response);\r\n        });\r\n    }\r\n    componentDidMount(){\r\n        document.title = title;\r\n        share('cash-gift');\r\n        request('act/cash-grab-every-day').then(response => {\r\n            let {code, data, message} = response;\r\n            let {flag: receive, acted_flag: apply, cash, coupon: coupons} = response.data;\r\n            if([0, -1001].indexOf(code) >= 0){\r\n                this.setState({\r\n                    // 是否点击申请\r\n                    receive,\r\n                    // 是否领取过奖励\r\n                    apply,\r\n                    coupons,\r\n                    cash,\r\n                    loaded: 1\r\n                });\r\n            }else{\r\n                this.middleware.apply(this, response);\r\n            }\r\n        }).catch(this.m.bind(this));\r\n    }\r\n    m(response){\r\n        let {code, data, message} = response;\r\n        Toast.hide();\r\n        this.setState({\r\n            loaded: 1\r\n        });\r\n        if(code != -1001){\r\n            Toast.fail(message, 1.5);\r\n        }\r\n        lock = true;\r\n    }\r\n    middleware(response){\r\n        let {code, data, message} = response;\r\n        Toast.hide();\r\n        this.setState({\r\n            loaded: 1\r\n        });\r\n        if(code === -1001){\r\n            this.setState({\r\n                prompt: 1\r\n            });\r\n        }else{\r\n            Toast.fail(message, 1.5);\r\n        }\r\n        lock = true;\r\n    }\r\n    receive(){\r\n        let {receive, apply, cash, coupons} = this.state;\r\n        if(lock){\r\n            lock = !lock;\r\n            Toast.loading(undefined, 0);\r\n            request('act/act-flag-user?key=cashGrabEveryDayAct_act&tag=h5-20170323-cashGrabEveryDayAct_act').then(() => {\r\n                if(!!cash && !!coupons){\r\n                    this.setState({\r\n                        apply: 1\r\n                    });\r\n                    setTimeout(() => {\r\n                        this.setState({\r\n                            visible: 1\r\n                        })\r\n                        lock = !lock;\r\n                        Toast.hide();\r\n                    }, 1500);\r\n                }else{\r\n                    this.setState({\r\n                        prompt: 2\r\n                    });\r\n                    lock = !lock;\r\n                    Toast.hide();\r\n                }\r\n            }).catch(this.middleware.bind(this));\r\n        }\r\n    }\r\n    check(){\r\n        let {apply, cash, coupons} = this.state;\r\n        if(!!apply && !!cash && !!coupons){\r\n            this.setState({\r\n                visible: 1\r\n            });\r\n        }else{\r\n            this.setState({\r\n                prompt: 2\r\n            });\r\n        }\r\n    }\r\n    close(){\r\n        this.setState({\r\n            visible: 0\r\n        });\r\n    }\r\n    prompt(){\r\n        this.setState({\r\n            prompt: 0\r\n        });\r\n    }\r\n    login(){\r\n        let {tag} = this.props.location.query;\r\n        if(tag){\r\n            login(tag);\r\n        }else{\r\n            login();\r\n        }\r\n        \r\n    }\r\n    apply(){\r\n        if(lock){\r\n            lock = !lock;\r\n            Toast.loading(undefined, 0);\r\n            request('act/act-flag-user?key=cashGrabEveryDayAct_act&tag=h5-20170323-cashGrabEveryDayAct_act').then(response => {\r\n                Toast.hide();\r\n                if(platform.isApp){\r\n                    hrefNative(4);\r\n                }else{\r\n                    window.location.href = resolveUrl('http://h5.xianjincard.com/mobile');\r\n                }\r\n            }).catch(this.middleware.bind(this));\r\n            lock = !lock;\r\n        }\r\n    }\r\n    render(){\r\n        let {receive, apply, loaded, visible, prompt, coupons, cash} = this.state;\r\n        return (\r\n            <div className={classnames({wrapper: true, loaded})}>\r\n                <div className='logo'/>\r\n                <div className={classnames({'wooden-chests': true, open: apply})}>\r\n                    <div className='wooden-chests-head'>\r\n                        <span className='light blue'/>\r\n                        <span className='light orange'/>\r\n                        <span className='gold'/>\r\n                    </div>\r\n                    <div className='wooden-chests-body'>\r\n                        <div className='money'/>\r\n                    </div>\r\n                </div>\r\n                <div className='button-group'>\r\n                    <div className='button button-receive' onClick={this.receive.bind(this)}></div>\r\n                    <div className='button button-check' onClick={this.check.bind(this)}></div>\r\n                </div>\r\n                <div className='rules'>\r\n                    <div className='rules-content'>\r\n                        <p><span>1</span>活动时间：3月23日18:00—3月31日24:00</p>\r\n                        <p><span>2</span>参与对象：平台注册用户</p>\r\n                        <p><span>3</span>现金大礼包：礼包包含现金和1张借款免息券和一张抵扣券</p>\r\n                        <p><span>4</span>领取条件：点击领取现金大礼包后进行申请借款方可领取，每人限领一次</p>\r\n                        <p><span>5</span>奖品请至“我的”查看，券有效期20天</p>\r\n                        <p><span>6</span>本活动最终解释权归现金卡所有，与Apple.lnc无关</p>\r\n                    </div>\r\n                </div>\r\n                <Modal className='prize' visible={visible} onClose={this.close.bind(this)} maskClosable={true} transparent>\r\n                    <ul>\r\n                        {cash && (\r\n                            <li>\r\n                                <div className='primary'>\r\n                                    <p>\r\n                                        <span>{cash.value}</span>{cash.unit}\r\n                                    </p>\r\n                                </div>\r\n                                <div className='details'>\r\n                                    <div className='details-inner'>\r\n                                        <h5>{cash.title}</h5>\r\n                                        <p>请至”我的”查看领取</p>\r\n                                    </div>\r\n                                </div>\r\n                            </li>\r\n                        )}\r\n                        {(coupons && coupons.length) && coupons.map((coupon, index) => (\r\n                            <li key={index}>\r\n                                <div className='primary'>\r\n                                    <p>\r\n                                        <span>{coupon.value}</span>{coupon.unit}\r\n                                    </p>\r\n                                </div>\r\n                                <div className='details'>\r\n                                    <div className='details-inner'>\r\n                                        <h5>{coupon.title}</h5>\r\n                                        <p>有效期:自{coupon.start} - {coupon.end}</p>\r\n                                    </div>\r\n                                </div>\r\n                            </li>\r\n                        ))}\r\n                    </ul>\r\n                    <div className='button' onClick={this.close.bind(this)}>朕知道了</div>\r\n                </Modal>\r\n                <Modal className='prompt' visible={prompt === 1} onClose={this.prompt.bind(this)} maskClosable={true} transparent>\r\n                    <p>主人，还没有登录哦~</p>\r\n                    <div class='button' onClick={this.login.bind(this)}>立即登录</div>\r\n                </Modal>\r\n                <Modal className='prompt' visible={prompt === 2} onClose={this.prompt.bind(this)} maskClosable={true} transparent>\r\n                    <p>主人，你的红包已发放,请申请后领取~</p>\r\n                    <div class='button' onClick={this.apply.bind(this)}>马上申请</div>\r\n                </Modal>\r\n            </div>\r\n        );\r\n    }\r\n};"]}