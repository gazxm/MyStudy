{"version":3,"sources":["src\\js\\pages\\integral\\mall.js"],"names":["title","Item","hex2rgb","hex","color","toLowerCase","test","length","newColor","i","slice","concat","rgb","push","parseInt","join","Mall","state","visible","loaded","document","middleware","props","then","response","data","is_login","money","score","modules","module","setState","catch","bind","initialHeight","gallery","items","map","item","index","link","img","guides","backgroundImage","text","goods","icon","name","model","id","default_img","stock","active","status","sub_title","disc_price","price","type"],"mappings":"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","file":"mall.js","sourceRoot":"E:/MyStudy/Redux/app_four","sourcesContent":["/* eslint-disable */\r\nimport React, {Component} from 'react';\r\nimport {Link} from 'react-router';\r\nimport {Modal, List, Carousel} from 'antd-mobile';\r\nimport Slick from 'react-slick';\r\nimport classnames from 'classnames';\r\nimport request from 'common/request';\r\nimport {login, redirect} from 'utils';\r\n\r\nimport 'scss/integral/mall.component.scss';\r\nimport 'slick-carousel/slick/slick.css';\r\n\r\nlet title = '金币商城';\r\nlet Item = List.Item;\r\n\r\nfunction hex2rgb(hex){\r\n    let color = hex.toLowerCase();\r\n    if(color && /^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(color)){\r\n        if(color.length === 4){\r\n            let newColor = '#';\r\n            for(let i = 1; i < 4; i += 1){\r\n                newColor += color.slice(i, i + 1).concat(color.slice(i, i + 1));\r\n            }\r\n            color = newColor;\r\n        }\r\n        var rgb = [];\r\n        for(var i = 1; i < 7; i += 2){\r\n            rgb.push(parseInt('0x' + color.slice(i, i + 2)));\r\n        }\r\n        return rgb.join(',');  \r\n    }else{\r\n        return color;\r\n    }\r\n}\r\n\r\nexport default class Mall extends Component{\r\n    state = {\r\n        visible: 0,\r\n        loaded: 0\r\n    }\r\n    componentDidMount(){\r\n        document.title = title;\r\n        let {middleware} = this.props;\r\n        request('credit-gold/shop-index').then(response => {\r\n            let {is_login, score: money, module: modules} = response.data;\r\n            this.setState({\r\n                is_login,\r\n                money,\r\n                modules,\r\n                loaded: 1\r\n            })\r\n        }).catch(middleware.bind(this));\r\n    }\r\n    render(){\r\n        let {is_login, money, modules, loaded, visible, initialHeight} = this.state;\r\n        let gallery = data => {\r\n            let {items} = data;\r\n            return (\r\n                <div>\r\n                    <Carousel infinite dots={items.length > 1} autoplay={items.length > 1} variableWidth>\r\n                        {(items && items.length) && items.map((item, index) => (\r\n                            <a key={index} className='slider-slide-link' href={item.link}>\r\n                                <img src={item.img}/>\r\n                            </a>\r\n                        ))}\r\n                    </Carousel>\r\n                    <div className='main'>\r\n                        {is_login ?\r\n                            <div className='money'>\r\n                                可用金币\r\n                                <Link to='/signin/detailed'>{money}</Link>\r\n                            </div>\r\n                        : <a className='login' onClick={login}>登陆查看金币数</a>}\r\n                        <a className='instruction' onClick={() => this.setState({visible: 1})}>金币是什么?</a>\r\n                    </div>\r\n                </div>\r\n            )\r\n        };\r\n        let guides = data => {\r\n            let {items} = data;\r\n            // let creteBackgroundColor = (color, index) => {\r\n            //     let opacity = .75;\r\n            //     let style = document.createElement('style');\r\n            //         style.type = 'text/css';\r\n            //         style.innerHTML = `\r\n            //             .guides-background-color-${index}{\r\n            //                 background-image: linear-gradient(to bottom, rgba(${hex2rgb(color)}, ${opacity}) 0%, ${color} 100%);\r\n            //                 background-image: -o-linear-gradient(to bottom, rgba(${hex2rgb(color)}, ${opacity}) 0%, ${color} 100%);\r\n            //                 background-image: -moz-linear-gradient(to bottom, rgba(${hex2rgb(color)}, ${opacity}) 0%, ${color} 100%);\r\n            //                 background-image: -webkit-linear-gradient(top, rgba(${hex2rgb(color)}, ${opacity}) 0%, ${color} 100%);\r\n            //             }\r\n            //         `;\r\n            //     document.head.appendChild(style);\r\n            // }\r\n            return (\r\n                <div className='guides'>\r\n                    <Slick arrows={false} infinite={false} slidesToShow={3} slidesToScroll={3} variableWidth>\r\n                        {(items && items.length) && items.map((item, index) => (\r\n                            <div key={index}>\r\n                                {\r\n                                    // creteBackgroundColor(item.color, index)\r\n                                }\r\n                                <a href={item.link} style={item.img ? {backgroundImage: `url(${item.img})`} : ''}>{item.text}</a>\r\n                            </div>\r\n                        ))}\r\n                    </Slick>\r\n                </div>\r\n            )\r\n        };\r\n        let goods = data => {\r\n            let {items} = data;\r\n            return (\r\n                <div className='goods'>\r\n                    <List renderHeader={() => (\r\n                        <div className='header'>\r\n                            <div className='title' style={data.color ? {color: data.color} : {}}>\r\n                                {data.icon ? <i className='icon' style={{backgroundImage: `url(${data.icon})`}}/> : ''}\r\n                                {data.name}\r\n                            </div>\r\n                            <a href={data.link} className='more'>更多</a>\r\n                        </div>\r\n                    )}>\r\n                        {(items && items.length) ?\r\n                            <ul className={classnames({\r\n                                'body': data.model == 1,\r\n                                'body-grid': data.model == 2\r\n                            })}>\r\n                                {items.map((item, index) => (\r\n                                    <li key={index} onClick={() => redirect.push(`/integral-mall/details?id=${item.id}`)}>\r\n                                        <div><div className='picture' style={item.default_img ? {backgroundImage: `url(${item.default_img})`} : {}}/></div>\r\n                                        <div className='description'>\r\n                                            <div className='title'>\r\n                                                <span>{item.name}</span>\r\n                                                {data.model == 1 ?\r\n                                                    <span className={classnames({\r\n                                                        stock: true,\r\n                                                        active: (item.stock > 0 || item.status)\r\n                                                    })}>\r\n                                                        {(item.stock > 0) ? `剩余${item.stock}份` : (item.status ? '抢购中' : '已抢完')}\r\n                                                    </span>\r\n                                                : ''}\r\n                                            </div>\r\n                                            <div className='details'>\r\n                                                {(data.model == 1) ?\r\n                                                    <div className='subtitle'>{item.sub_title || ''}</div>\r\n                                                : ''}\r\n                                                <div className='money'>\r\n                                                    <span>{item.disc_price > 0 ? item.disc_price : item.price}</span>金币\r\n                                                </div>\r\n                                                {data.model == 1 ?\r\n                                                    <div className={classnames({'exchange': true, 'disabled': (item.status == 0 && item.stock <= 0)})} onClick={() => redirect.push(`/integral-mall/details?id=${item.id}`)}>\r\n                                                        {(item.status == 0 && item.stock <= 0) ? '已售罄' : '立即兑换'}\r\n                                                    </div>\r\n                                                : ''}\r\n                                                {data.model == 2 ? <div className={classnames({'status': true, active: item.status == 0})}>\r\n                                                    {item.status ? '抢购中' : '已抢完'}\r\n                                                </div> : ''}\r\n                                            </div>\r\n                                        </div>\r\n                                    </li>\r\n                                ))}\r\n                            </ul>\r\n                        : <div className='empty'>暂无数据</div>}\r\n                    </List>\r\n                </div>\r\n            )\r\n        };\r\n        return (\r\n            <div className={classnames({'wrapper wrapper-integral-mall': true, loaded})}>\r\n                {(modules && modules.map((module, index) => (\r\n                    <div className='module' key={index}>\r\n                        {module.type == 'gold_shop_page_banner' && gallery(module, index)}\r\n                        {(module.type == 'gold_shop_page_icon' && (module.items && module.items.length)) && guides(module, index)}\r\n                        {module.type == 'gold_shop_page_goods' && goods(module, index)}\r\n                    </div>\r\n                )))}\r\n                <Modal className='integral-mall-modal-instruction' title='金币说明' visible={visible} onClose={() => this.setState({visible: 0})} maskClosable={true} transparent>\r\n                    <div>\r\n                        <h6>金币的定义：</h6>\r\n                        <p>金币是现金卡的一种虚拟货币，注册用户可通过签到、完成任务、参与活动、玩游戏等渠道获得，可用于兑换相应的优惠，更多金币玩法正在开发中。</p>\r\n                        <h6>金币的清算规：</h6>\r\n                        <p>每年1月1日和7月1日，将对半年前的金币进行清算，到期未用完的金币清算后将失效，所以要抓紧时间兑换哦！</p>\r\n                        <p>例：2017年1月1日~7月1日期间获得5万金币，2017年7月1日~12月31日获得5万金币，花费3万金币，则2018年1月1日进行清算后，2017年1月1日~7月1日未用完的2万金币将失效，清算后账户金币总数为5万金币，以此类推。</p>\r\n                        <span>金币的最终解释权归现金卡所有</span>\r\n                    </div>\r\n                </Modal>\r\n            </div>\r\n        );\r\n    }\r\n};"]}