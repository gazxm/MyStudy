{"version":3,"sources":["src\\js\\pages\\misc\\approve\\login.js"],"names":["Approve","props","state","id","location","query","icon","name","btnActive","username","password","smscode","piccode","smsText","canSend","successLayout","intval","document","title","InitsParams","platform_id","loading","then","data","response","code","fail","message","hide","setState","info","phone","isauth","reSendSmsCode","e","params","checkcode","thistime","time","that","setInterval","clearInterval","target","value","checkBtnStatus","hcPassword","bind","hcSmscode","hcPiccode","handleClick","Component"],"mappings":"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","file":"login.js","sourceRoot":"E:/MyStudy/Redux/app_four","sourcesContent":["import React, {Component}  from 'react'\r\nimport {NoticeBar, Carousel, List, Modal, Icon, Toast, Flex} from 'antd-mobile';\r\nimport {get, post, login} from 'utils'\r\nimport 'scss/misc/approve.component.scss'\r\n\r\n\r\nexport default class Approve extends React.Component {\r\n    //初始化加载\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            id : this.props.location.query.id,\r\n            icon : \"\",\r\n            name : \"\",\r\n            btnActive : 0,\r\n            username : \"\",\r\n            password : \"\",\r\n            smscode : \"\",\r\n            piccode : \"\",\r\n            smsText : \"获取验证码\",\r\n            canSend : 0,\r\n            successLayout : 0\r\n        };\r\n        this.intval;\r\n    }\r\n\r\n    componentWillMount(){\r\n        document.title = '借贷认证';\r\n        var InitsParams = {};\r\n        InitsParams.platform_id = this.state.id;\r\n        Toast.loading(\"加载中\", 0);\r\n        post('http://credit.xianjincard.com/approve-auth/inits-approve-page',InitsParams).then(data => data.data).then(response => {\r\n            if(response.code != 0) {\r\n                Toast.fail(response.message, 1.5);\r\n                return;\r\n            }\r\n            Toast.hide();\r\n            this.setState({\r\n                icon : response.data.info.icon,\r\n                name : response.data.info.name,\r\n                username : response.data.phone,\r\n                successLayout : response.data.isauth\r\n            });\r\n        });\r\n        if(this.state.id == 6){\r\n            //现金巴士一进来就发短信验证码\r\n            this.reSendSmsCode();\r\n        }\r\n\r\n    }\r\n\r\n    componentDidMount() {\r\n        //console.log(\"b\")\r\n    }\r\n\r\n    fetchData() {\r\n        // get('http://credit.xianjincard.com/credit-app/multi-index').then(result => {console.log(result)})\r\n    }\r\n    handleClick(e){\r\n        if(this.state.btnActive != 1){\r\n            //信息不完整,不可以提交\r\n            return;\r\n        }\r\n        var params = {};\r\n        params.phone = this.state.username;\r\n        params.password = this.state.password;\r\n        params.platform_id = this.state.id;\r\n        if(this.state.id == \"6\") {\r\n            params.checkcode = this.state.smscode;\r\n        }else if(this.state.id == \"7\") {\r\n            params.checkcode = this.state.piccode;\r\n        }\r\n        Toast.loading(\"认证中\", 0);\r\n        post('http://credit.xianjincard.com/approve-auth/submit-approve-info',params).then(data => data.data).then(response => {\r\n            if(response.code != 0) {\r\n                if(response.code != 1000) {\r\n                    Toast.fail(response.message, 1.5);\r\n                }else{\r\n                    Toast.fail(\"目前服务不可用,请稍候再试。\", 1.5);\r\n                }\r\n                return;\r\n            }\r\n            Toast.hide();\r\n            //认证成功\r\n            this.setState({\r\n                successLayout : 1\r\n            });\r\n        });\r\n    }\r\n    reSendSmsCode() {\r\n        var params = {};\r\n        params.platform_id = this.state.id;\r\n        Toast.loading(\"验证码发送中...\", 0);\r\n        post('http://credit.xianjincard.com/approve-auth/get-sms-code',params).then(data => data.data).then(response => {\r\n            if(response.code != 0 && response.code != -2) {\r\n                if(response.code != 1000) {\r\n                    Toast.fail(response.message, 1.5);\r\n                }else{\r\n                    Toast.fail(\"目前服务不可用,请稍候再试。\", 1.5);\r\n                }\r\n                this.setState({\r\n                    smsText : \"获取验证码\",\r\n                    canSend : 1\r\n                })\r\n                return;\r\n            }\r\n            Toast.hide();\r\n            this.setState({\r\n                canSend : 0\r\n            })\r\n            var thistime = response.data.time;\r\n            var that = this;\r\n            this.intval = setInterval(function () {\r\n                thistime--;\r\n                that.setState({\r\n                    smsText : thistime\r\n                },function () {\r\n                    if(that.state.smsText == 1){\r\n                        clearInterval(that.intval);\r\n                        that.setState({\r\n                            smsText : \"获取验证码\",\r\n                            canSend : 1\r\n                        })\r\n                    }\r\n                });\r\n            },1000);\r\n        });\r\n    }\r\n    checkBtnStatus() {\r\n        if (this.state.password != \"\") {\r\n            switch (this.state.id) {\r\n                default :\r\n                    this.setState({btnActive: 1});\r\n                    break;\r\n                case \"6\" : //现金巴士 需要 短信验证码\r\n                    if (this.state.smscode != \"\") {\r\n                        this.setState({btnActive: 1});\r\n                    }else{\r\n                        this.setState({btnActive : 0 });\r\n                    }\r\n                    break;\r\n            }\r\n        }else{\r\n            this.setState({btnActive : 0 });\r\n        }\r\n    }\r\n    hcPassword(e){\r\n        this.setState({\r\n            password: e.target.value\r\n        },function () {\r\n            this.checkBtnStatus();\r\n        })\r\n    }\r\n    hcSmscode(e){\r\n        this.setState({\r\n            smscode: e.target.value\r\n        },function () {\r\n            this.checkBtnStatus();\r\n        })\r\n    }\r\n    hcPiccode(e){\r\n        this.setState({\r\n            piccode: e.target.value\r\n        },function () {\r\n            this.checkBtnStatus();\r\n        })\r\n    }\r\n    render() {\r\n        return (\r\n            <div class=\"login\">\r\n                <div class=\"header\">\r\n                    <img src={this.state.icon} />\r\n                </div>\r\n                <div class=\"title\">{this.state.name}</div>\r\n                {this.state.successLayout == 0 ?\r\n                <div class=\"main\">\r\n                    <div class=\"list\">\r\n                        <input id=\"username\" value={this.state.username} placeholder=\"平台用户名\" disabled type=\"text\" />\r\n                    </div>\r\n                    <div class=\"list\">\r\n                        <input id=\"password\" value={this.state.password} onChange={this.hcPassword.bind(this)} placeholder=\"平台密码\" type=\"password\" />\r\n                    </div>\r\n                    {this.state.id == \"6\" ?\r\n                    <div class=\"list\">\r\n                        <div class=\"left\">\r\n                            <input id=\"smscode\" value={this.state.smscode} onChange={this.hcSmscode.bind(this)} placeholder=\"输入验证码\" type=\"text\" />\r\n                        </div>\r\n                        {this.state.canSend == 0 ?\r\n                            <div class=\"right\">\r\n                                <a href=\"javascript:void(0)\" class=\"sms-code\">{this.state.smsText}</a>\r\n                            </div>\r\n                            :\r\n                            <div onClick={this.reSendSmsCode.bind(this)} class=\"right active\">\r\n                                <a href=\"javascript:void(0)\" class=\"sms-code\">{this.state.smsText}</a>\r\n                            </div>\r\n                        }\r\n                    </div>\r\n                    : \"\"}\r\n                    {this.state.id == \"7\" ?\r\n                    <div class=\"list hide\">\r\n                        <div class=\"left\">\r\n                            <input id=\"piccode\" value={this.state.piccode} onChange={this.hcPiccode.bind(this)} placeholder=\"输入图片验证码\" type=\"password\" />\r\n                        </div>\r\n                        <div class=\"right\">\r\n                            <img class=\"pic-code\" src=\"http://localhost/April/Index.php/Home/Api/getCode/num/4/w/145/h/44.html\" />\r\n                        </div>\r\n                    </div>\r\n                    : \"\"}\r\n                    <div class=\"list pd-top\">\r\n                        {this.state.btnActive == 0 ?\r\n                            <a onClick={this.handleClick.bind(this)} href=\"javascript:void(0)\" class=\"btn\">开始认证</a>\r\n                        :\r\n                            <a onClick={this.handleClick.bind(this)} href=\"javascript:void(0)\" class=\"btn active\">开始认证</a>\r\n                        }\r\n                    </div>\r\n                </div>\r\n                :\r\n                <div>\r\n                    <img class=\"auth_done_icon\" src=\"/assets/img/misc/approve/already_auth.png\"/>\r\n                    <div class=\"main\">\r\n                        <div class=\"list pd-top\">\r\n                            <a href=\"javascript:void(0)\" class=\"btn success\">已认证</a>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                }\r\n            </div>\r\n        )\r\n    }\r\n}\r\n"]}