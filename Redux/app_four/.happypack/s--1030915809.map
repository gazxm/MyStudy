{"version":3,"sources":["src\\js\\pages\\activity\\turntable\\Turntable.js"],"names":["appMarket","goldConsume","Turntable","props","state","lotteryNumber","locked","isError","isLogin","code","inviteCode","gold","arr","document","title","loading","then","data","hide","setState","list","invite_code","alert","errorHtml","times","content","query","location","loginHtml","source_tag","click","userLogin","info","length","rewardHtml","reward","map","v","i","time","join","goldHtml","setTimeout","push","bind","exchange","Component"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;;;;;AAEA,IAAM,YAAN,AAAkB;AAClB,IAAM,cAAN,AAAoB;;IAEC,A;qCACnB;;qBAAA,AAAa,OAAO;wCAAA;;4IAAA,AACZ,AACN;;UAAA,AAAK;qBAAQ,AACI,AACf;cAFW,AAEH,AACR;eAHW,AAGF,AACT;eAJW,AAIF,AACT;YALW,AAKL,AACN;kBANW,AAMC,AACZ;YAPW,AAOL,AACN;WAVgB,AAElB,AAAa,AAQN;AARM,AACX;WASH;;;;;wCAEoB;mBACnB;;eAAA,AAAS,QAAT,AAAiB,AACjB;wBAAA,AAAM,AACN;sBAAA,AAAM,QAAN,AAAc,AACd;sBAAA,AAAI,8DAAJ,AAAkE,KAAK,gBAAA;eAAQ,KAAR,AAAa;AAApF,SAAA,AAA0F,KAAK,gBAAQ,AACrG;wBAAA,AAAM,AACN;YAAI,KAAA,AAAK,SAAL,AAAc,KAAK,KAAA,AAAK,SAAS,CAArC,AAAsC,MAAM,AAC1C;iBAAA,AAAK;qBAAS,AACH,AACT;kBAAM,KAFR,AAAc,AAED,AAEb;AAJc,AACZ;cAGE,KAAA,AAAK,SAAS,CAAlB,AAAmB,MAAM,AACvB;mBAAA,AAAK;mBACE,KAAA,AAAK,KADZ,AAAc,AACG,AAElB;AAHe,AACZ;AAGJ;cAAI,KAAA,AAAK,KAAT,AAAc,aAAa,AACzB;mBAAA,AAAK;0BACS,KAAA,AAAK,KADnB,AAAc,AACU,AAEzB;AAHe,AACZ;AAGJ;0BAAA,AAAM,MAAM,kBAAA,AAAQ,UAAU,KAA9B,AAAY,AAAuB,OAAnC,AAA0C,AAC1C;AACD;AACD;YAAI,KAAA,AAAK,SAAS,CAAlB,AAAmB,MAAM,AACvB;iBAAA,AAAK;qBAAL,AAAc,AACH,AAEX;AAHc,AACZ;AAGH;AACD;YAAI,KAAA,AAAK,KAAL,AAAU,SAAd,AAAuB,MAAM,AAC3B;eAAA,AAAK,KAAL,AAAU,OAAV,AAAiB,AAClB;AACD;eAAA,AAAK;mBAAS,AACH,AACT;yBAAe,KAAA,AAAK,KAFR,AAEa,AACzB;sBAAY,KAAA,AAAK,KAHL,AAGU,AACtB;gBAAM,KAAA,AAAK,KAJC,AAII,AAChB;eAAK,KAAA,AAAK,KALZ,AAAc,AAKG,AAElB;AAPe,AACZ;AA9BJ,AAqCD;;;;8B,AAEU,SAAS;mBACQ,KADR,AACa;UADb,AACV,iBADU,AACV;UADU,AACD,cADC,AACD,AACjB;;UAAM,QAAQ,KAAA,AAAK,MAAL,AAAW,SAAzB,AAAkC,AAClC;UAAM,aAAa,MAAA,AAAM,eAAe,MAAA,AAAM,gBAA3B,AAA2C,cAAc,MAAzD,AAA+D,cAAlF,AAAgG,AAChG;UAAA,AAAI,SAAS,AACX;wBAAA,AAAM,MAAM,kBAAA,AAAQ,UAApB,AAAY,AAAkB,OAA9B,AAAqC,AACrC;AACD;AACD;sBAAA,AAAM,MAAM,kBAAA,AAAQ,UAApB,AAAY,AAAkB,UAA9B,AAAwC,AACxC;UAAI,MAAJ,AAAU,YAAY,AACpB;wBAAA,AAAM,MAAN,AAAY,WAAW,YAAM,AAAE;4BAAM,MAAN,AAAY,YAAZ,AAAwB,AAAa;AAApE,AACA;AACD;AACD;sBAAA,AAAM,MAAN,AAAY,WAAW,YAAM,AAAE;0BAAA,AAAM,WAAN,AAAiB,AAAa;AAA7D,AACD;;;;6BAES;oBAC+B,KAD/B,AACoC;UADpC,AACA,kBADA,AACA;UADA,AACS,cADT,AACS;UADT,AACc,iBADd,AACc;UADd,AACsB,eADtB,AACsB,AAC9B;;UAAI,CAAA,AAAC,WAAW,SAAS,CAAzB,AAA0B,MAAM,AAC9B;aAAA,AAAK,AACL;AACD;AACD;UAAI,CAAJ,AAAK,QAAQ,AACX;wBAAA,AAAM,KAAN,AAAW,mBAAX,AAA8B,AAC9B;AACD;AACD;UAAI,CAAC,IAAL,AAAS,QAAQ,AACf;wBAAA,AAAM,MAAM,kBAAZ,AAAY,AAAQ,cAApB,AAAkC,AAClC;AACD;AACD;UAAM,aAAS,AAAI,IAAI,UAAA,AAAC,GAAD,AAAI,GAAJ;6BAAA,AAAsB,WAAM,EAA5B,AAA8B,gBAAW,EAAzC,AAA2C,QAA3C;AAAR,OAAA,EAAA,AAAqE,KAApF,AAAe,AAA0E,AACzF;sBAAA,AAAM,MAAM,kBAAA,AAAQ,WAApB,AAAY,AAAmB,SAA/B,AAAwC,AACzC;;;;+BAEW;mBAAA;;oBACwB,KADxB,AAC6B;UAD7B,AACF,kBADE,AACF;UADE,AACO,iBADP,AACO;UADP,AACe,eADf,AACe;UADf,AAEJ,gBAAkB,KAFd,AAEmB,MAFnB,AAEJ,AACN;;UAAI,CAAJ,AAAK,SAAS,AACZ;aAAA,AAAK,UAAL,AAAe,AACf;AACD;AACD;UAAI,CAAJ,AAAK,QAAQ,AACX;wBAAA,AAAM,KAAN,AAAW,iBAAX,AAA4B,AAC5B;AACD;AACD;UAAI,QAAJ,AAAY,aAAa,AACvB;wBAAA,AAAM,MAAM,kBAAA,AAAQ,SAAR,AAAiB,MAA7B,AAAY,AAAuB,cAAnC,AAAiD,AACjD;wBAAA,AAAM,MAAN,AAAY,WAAW,YAAM,AAC3B;0BAAA,AAAI,wEAAJ,AAA4E,KAAK,gBAAA;mBAAQ,KAAR,AAAa;AAA9F,aAAA,AAAoG,KAAK,gBAAQ,AAC/G;gBAAI,KAAA,AAAK,SAAL,AAAc,KAAK,KAAA,AAAK,SAAS,CAArC,AAAsC,MAAM,AAC1C;yBAAW,YAAM,AACf;gCAAA,AAAM,MAAM,kBAAA,AAAQ,UAAU,KAA9B,AAAY,AAAuB,OAAnC,AAA0C,AAC3C;AAFD,iBAAA,AAEG,AACH;AACD;AACD;gBAAI,KAAA,AAAK,SAAS,CAAlB,AAAmB,MAAM,AACvB;yBAAW,YAAM,AACf;gCAAA,AAAM,MAAM,kBAAA,AAAQ,UAAU,CAAlB,AAAmB,MAA/B,AAAY,AAAyB,OAArC,AAA4C,AAC5C;gCAAA,AAAM,MAAN,AAAY,WAAW,YAAM,AAC3B;kCAAA,AAAS,KAAT,AAAc,AACf;AAFD,AAGD;AALD,iBAAA,AAKG,AACH;AACD;AACD;mBAAA,AAAK;6BACY,EADH,AACK,AACjB;oBAAM,OAFR,AAAc,AAEC,AAEf;AAJc,AACZ;4BAGF,AAAM,KAAN,AAAW,QAAX,AAAmB,AACpB;AArBD,AAsBD;AAvBD,AAwBA;AACD;AACD;sBAAA,AAAM,MAAM,kBAAA,AAAQ,UAAU,CAAlB,AAAmB,MAA/B,AAAY,AAAyB,OAArC,AAA4C,AAC5C;sBAAA,AAAM,MAAN,AAAY,WAAW,YAAM,AAC3B;wBAAA,AAAS,KAAT,AAAc,AACf;AAFD,AAGD;;;;6BAES;UAAA,AACA,gBAAkB,KADlB,AACuB,MADvB,AACA,AAER;;aACE,gBAAA,cAAA,SAAK,WAAL,AAAe,AACb,sCAAA,cAAA,SAAK,WAAL,AAAe,AACb,sDAAK,WADP,AACE,AAAe,AACf,2BAAA,cAAA,SAAK,WAAL,AAAe,AACb,6DADF,AAEE,yDAAQ,MAFV,AAEE,AAAc,AACd,yBAAA,cAAA,OAAG,WAAH,AAAa,YAAY,sCAAA,cAAA,KAAI,MAA7B,AAAyB,gBAH3B,AAGE,AACA,mDAAA,cAAA,OAAG,WAAH,AAAa,AAAS,4BAAA,cAAA,UAAM,SAAS,KAAA,AAAK,OAAL,AAAY,KAA3B,AAAe,AAAiB,SAJxD,AAIE,AAAsB,AACtB,0DAAA,cAAA,OAAG,WAAH,AAAa,eAAc,SAAS,KAAA,AAAK,SAAL,AAAc,KAAlD,AAAoC,AAAmB,SALzD,AAKE,AACA,0FAAG,WANL,AAME,AAAa,AACb,2BAAA,cAAA,SAAK,WAAL,AAAe,AACb,0BAAA,cAAA,MAAA,MADF,AACE,AACA,6CAAA,cAAA,KAAG,sBAAA,cAAA,KAAA,MAAH,AAAG,MAFL,AAEE,AACA,yEAAA,cAAA,KAAG,sBAAA,cAAA,KAAA,MAAH,AAAG,MAHL,AAGE,AACA,6FAAA,cAAA,KAAG,sBAAA,cAAA,KAAA,MAAH,AAAG,MAAiB,8FAApB,AAA0B,uBAAA,cAAA,QAAA,MAAwB,+IAAxB,OAAiE,gPAAjE,OAAqF,uHAArF,OAA8F,gBAA9F,aAAuH,sHAAvH,OAJ5B,AAIE,AAA0B,AAC1B,kKAAA,cAAA,KAAG,sBAAA,cAAA,KAAA,MAAH,AAAG,MAAe,kFAAlB,AAAwB,uBAAA,cAAA,QAAA,MAAkD,uRAAlD,OAL1B,AAKE,AAAwB,AACxB,wRAAA,cAAA,KAAG,sBAAA,cAAA,KAAA,MAAH,AAAG,MANL,AAME,AACA,yJAAA,cAAA,KAAG,sBAAA,cAAA,KAAA,MAAH,AAAG,MAAgB,oEAAA,cAAA,UAAM,WAAN,AAAgB,SAAnC,AAAmB,eAPrB,AAOE,AACA,2BAAA,cAAA,KAAG,sBAAA,cAAA,KAAA,MAAH,AAAG,MAnBb,AACE,AACE,AAEE,AAOE,AAQE,AAMX;;;;EArKoC,gBAAM,A;;kBAAxB,A","file":"Turntable.js","sourceRoot":"E:/MyStudy/Redux/app_four","sourcesContent":["import React from 'react'\r\nimport Scroll from './Scroll'\r\nimport Rotate from './Rotate'\r\nimport Content from './Content'\r\nimport Popup from '../components/Popup'\r\nimport Toast from '../../../components/Toast'\r\nimport { login, get, share, redirect } from 'utils'\r\nimport 'scss/activity/turntable.component.scss'\r\n\r\nconst appMarket = 'Turntable'\r\nconst goldConsume = 100\r\n\r\nexport default class Turntable extends React.Component {\r\n  constructor (props) {\r\n    super(props)\r\n    this.state = {\r\n      lotteryNumber: 0,\r\n      locked: 1,\r\n      isError: 0,\r\n      isLogin: 0,\r\n      code: 0,\r\n      inviteCode: '',\r\n      gold: 0,\r\n      arr: []\r\n    }\r\n  }\r\n\r\n  componentDidMount () {\r\n    document.title = '现金卡大转盘'\r\n    share('Turntable')\r\n    Toast.loading('')\r\n    get('http://credit.xianjincard.com/activity/turntable-act/index').then(data => data.data).then(data => {\r\n      Toast.hide()\r\n      if (data.code !== 0 && data.code !== -1001) {\r\n        this.setState({\r\n          isError: 1,\r\n          code: data.code\r\n        })\r\n        if (data.code === -2013) {\r\n          this.setState({\r\n            arr: data.data.list\r\n          })\r\n        }\r\n        if (data.data.invite_code) {\r\n          this.setState({\r\n            inviteCode: data.data.invite_code\r\n          })\r\n        }\r\n        Popup.alert(Content.errorHtml(data.code), 'popup popup-error')\r\n        return\r\n      }\r\n      if (data.code === -1001) {\r\n        this.setState({\r\n          isLogin: 0\r\n        })\r\n        return\r\n      }\r\n      if (data.data.gold === null) {\r\n        data.data.gold = 0\r\n      }\r\n      this.setState({\r\n        isLogin: 1,\r\n        lotteryNumber: data.data.times,\r\n        inviteCode: data.data.invite_code,\r\n        gold: data.data.gold,\r\n        arr: data.data.list\r\n      })\r\n    })\r\n  }\r\n\r\n  userLogin (content) {\r\n    const { isError, code } = this.state\r\n    const query = this.props.location.query\r\n    const inviteCode = query.invite_code && query.invite_code !== 'undefined' ? query.invite_code : ''\r\n    if (isError) {\r\n      Popup.alert(Content.errorHtml(code), 'popup popup-error')\r\n      return\r\n    }\r\n    Popup.alert(Content.loginHtml(content), 'popup')\r\n    if (query.source_tag) {\r\n      Popup.click('a.login', () => { login(query.source_tag, inviteCode) })\r\n      return\r\n    }\r\n    Popup.click('a.login', () => { login(appMarket, inviteCode) })\r\n  }\r\n\r\n  reward () {\r\n    const { isLogin, arr, locked, code } = this.state\r\n    if (!isLogin && code !== -2013) {\r\n      this.userLogin()\r\n      return\r\n    }\r\n    if (!locked) {\r\n      Toast.info('亲，请等待抽奖完再查看奖励哦！', 2)\r\n      return\r\n    }\r\n    if (!arr.length) {\r\n      Popup.alert(Content.rewardHtml(), 'popup')\r\n      return\r\n    }\r\n    const reward = arr.map((v, i) => `<li key={${i}}>${v.time} <b>${v.title}</b></li>`).join('')\r\n    Popup.alert(Content.rewardHtml(reward), 'popup')\r\n  }\r\n\r\n  exchange () {\r\n    const { isLogin, locked, gold } = this.state\r\n    let { lotteryNumber } = this.state\r\n    if (!isLogin) {\r\n      this.userLogin('3')\r\n      return\r\n    }\r\n    if (!locked) {\r\n      Toast.info('亲，请等待抽奖完再兑换哦！', 2)\r\n      return\r\n    }\r\n    if (gold >= goldConsume) {\r\n      Popup.alert(Content.goldHtml(gold, goldConsume), 'popup')\r\n      Popup.click('a.click', () => {\r\n        get('http://credit.xianjincard.com//activity/turntable-act/exchange-times').then(data => data.data).then(data => {\r\n          if (data.code !== 0 && data.code !== -2031) {\r\n            setTimeout(() => {\r\n              Popup.alert(Content.errorHtml(data.code), 'popup popup-error')\r\n            }, 350)\r\n            return\r\n          }\r\n          if (data.code === -2031) {\r\n            setTimeout(() => {\r\n              Popup.alert(Content.errorHtml(-2031, gold), 'popup')\r\n              Popup.click('a.click', () => {\r\n                redirect.push('/signin')\r\n              })\r\n            }, 350)\r\n            return\r\n          }\r\n          this.setState({\r\n            lotteryNumber: ++lotteryNumber,\r\n            gold: gold - goldConsume\r\n          })\r\n          Toast.info('兑换成功', 2)\r\n        })\r\n      })\r\n      return\r\n    }\r\n    Popup.alert(Content.errorHtml(-2031, gold), 'popup')\r\n    Popup.click('a.click', () => {\r\n      redirect.push('/signin')\r\n    })\r\n  }\r\n\r\n  render () {\r\n    const { lotteryNumber } = this.state\r\n\r\n    return (\r\n      <div className='transition-group'>\r\n        <div className='turntable'>\r\n          <div className='head' />\r\n          <div className='content'>\r\n            <Scroll />\r\n            <Rotate Turn={this} />\r\n            <p className='chance'>您还有<b>{lotteryNumber}</b>次转盘机会</p>\r\n            <a className='reward'><span onClick={this.reward.bind(this)}>查看我的奖品</span></a>\r\n            <a className='gold-chance' onClick={this.exchange.bind(this)}>金币兑换转盘机会</a>\r\n            <i className='wave' />\r\n            <div className='rule'>\r\n              <h3>活动规则</h3>\r\n              <p><b>1</b>活动时间：2017.03.28起；</p>\r\n              <p><b>2</b>参与对象：平台注册会员；</p>\r\n              <p><b>3</b>如何获得转盘机会：<br /><span>活动期间首次登陆可获取抽奖机会1次；<br />邀请好友注册成功即可获取抽奖机会（邀请1人注册成功获取1次抽奖机会）；<br />申请借款可获得抽奖机会1次；<br />消耗{goldConsume}个金币来兑换一次抽奖机会；<br />抽奖机会可以累计，不清零，每天抽奖次数上限10次。</span></p>\r\n              <p><b>4</b>如何领取奖品：<br /><span>券奖励于获奖后24小时内发放，请至“我的”-“我的优惠”中查看领取，所有券有效期20天。<br />获得实物奖的用户将收到平台短信，用户需在短信规定时间内联系客服验证信息，确认发放方式。</span></p>\r\n              <p><b>5</b>券不可累加使用，与平台其他活动优惠不能同享；</p>\r\n              <p><b>6</b>现金卡客服热线：<span className='tel'>4006812016</span>；</p>\r\n              <p><b>7</b>本活动最终解释权归现金卡平台所有，与Apple.Inc无关</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n"]}