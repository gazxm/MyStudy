'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _assign = require('babel-runtime/core-js/object/assign');

var _assign2 = _interopRequireDefault(_assign);

var _axios = require('axios');

var _axios2 = _interopRequireDefault(_axios);

var _utils = require('utils');

function _interopRequireDefault(obj) {
    return obj && obj.__esModule ? obj : { default: obj };
}

var url = function url(_url) {
    return (0, _utils.resolveUrl)(_url);
};

exports.default = function (options) {
    var config = {
        headers: {}
    };
    if (config.method && config.method.toUpperCase() === 'POST') {
        config.headers['Content-Type'] = 'application/x-www-form-urlencoded';
    }
    if (typeof options === 'string') {
        config.url = options;
    } else {
        config = (0, _assign2.default)(config, options);
    }
    if (!/^https?|^\/\//.test(options)) {
        config.url = url('http://credit.xianjincard.com/' + config.url.replace(/^\//, ''));
    }
    return (0, _axios2.default)(config).then(function (response) {
        return response.data;
    }).then(function (response) {
        var code = response.code,
            message = response.message;

        if (code !== 0) {
            throw response;
        }
        return response;
    });
};

module.exports = exports['default'];