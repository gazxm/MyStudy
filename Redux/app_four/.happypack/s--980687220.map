{"version":3,"sources":["src\\js\\pages\\security\\SecurityList.js"],"names":["security","Item","alert","text","textClass","SecurityList","store","list","securityFund","items","fetched","fetching","code","message","document","title","isMask","clearTimeout","timeout","props","dispatch","fetchSecurityList","nextProps","nextState","loading","hide","prevProps","prevState","onPress","info","length","replace","time","setTimeout","map","item","parseInt","status","poll","i","city","push","Component"],"mappings":"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","file":"SecurityList.js","sourceRoot":"E:/MyStudy/Redux/app_four","sourcesContent":["import React from 'react'\r\nimport { Modal, List, Button } from 'antd-mobile'\r\nconst Item = List.Item\r\nconst alert = Modal.alert\r\n\r\nimport {connect} from 'react-redux'\r\nimport { redirect, login } from 'utils'\r\nimport 'scss/components/fund-security.component.scss'\r\n\r\nimport * as security from '../../actions/securityFundActions'\r\nimport Toast from '../../components/Toast'\r\n\r\n// 0认证失败 1已认证 2认证中\r\nconst text = ['认证失败', '已认证', '认证中']\r\nconst textClass = ['fail', 'succeed', 'fail']\r\n\r\n@connect((store) => {\r\n  const list = store.securityFund.list\r\n  return {\r\n    items: list.items,\r\n    fetched: list.fetched,\r\n    fetching: list.fetching,\r\n    code: list.code,\r\n    message: list.message\r\n  }\r\n})\r\nexport default class SecurityList extends React.Component {\r\n  componentDidMount () {\r\n    document.title = '社保认证'\r\n    this.isMask = true\r\n    clearTimeout(this.timeout)\r\n    this.props.dispatch(security.fetchSecurityList())\r\n  }\r\n  componentWillUpdate (nextProps, nextState) {\r\n    const { fetching } = nextProps\r\n    if (this.isMask) {\r\n      fetching ? Toast.loading('加载中...') : Toast.hide()\r\n    }\r\n  }\r\n  componentDidUpdate (prevProps, prevState) {\r\n    const { fetched, code, message, items } = this.props\r\n    if (fetched && code === -3) {\r\n      alert('登录', '你还没有登录，请先登录', [\r\n        { text: '确 定', onPress: () => login() }\r\n      ])\r\n      return\r\n    }\r\n    if (fetched && code !== 0 && code !== 1 && code !== -3) {\r\n      Toast.info(message, 2)\r\n      return\r\n    }\r\n    if (fetched && items.length <= 0) redirect.replace('/security/certification')\r\n  }\r\n  componentWillUnmount () {\r\n    clearTimeout(this.timeout)\r\n  }\r\n  poll (time) {\r\n    this.timeout = setTimeout(() => {\r\n      this.isMask = false\r\n      this.props.dispatch(security.fetchSecurityList())\r\n    }, time * 1000)\r\n  }\r\n  render () {\r\n    const {items, fetched} = this.props\r\n    let list = null\r\n    if (fetched && items && items.length) {\r\n      items.map((item) => {\r\n        if (parseInt(item.status) === 2) {\r\n          this.poll(10)\r\n          return\r\n        }\r\n      })\r\n      list = items.map((item, i) => <Item key={i} extra={text[item.status]} className={textClass[item.status]}>{item.city}</Item>)\r\n    }\r\n    if (list === null) {\r\n      return null\r\n    }\r\n    return (\r\n      <div class=\"transition-group fund-security-certification\">\r\n        <List class=\"custom-list\">\r\n         {list}\r\n        </List>\r\n        <div class=\"custom-button\">\r\n          <Button className=\"btn\" type=\"primary\" onClick={() => { redirect.push('/security/certification') }}>{items ? '继续添加' : '添加'}</Button>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n"]}