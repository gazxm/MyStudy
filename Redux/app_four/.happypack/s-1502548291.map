{"version":3,"sources":["src\\js\\pages\\activity\\seckill\\Seckill.js"],"names":["prize","locked","appMarket","Seckill","props","state","scroll","code","nowTime","actSTime","actETime","ticket","query","location","loading","then","data","hide","setState","act_start_time","act_end_time","i","prizes","push","cur_time","alert","showHtml","click","is_login","source_tag","document","title","lt1","slice","lt2","setTimeout","type","text_amount","name","expire","unit","amount","left","tk","map","v","rob","bind","Component"],"mappings":"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","file":"Seckill.js","sourceRoot":"E:/MyStudy/Redux/app_four","sourcesContent":["import React from 'react'\r\nimport Scroll from './Scroll'\r\nimport Ticket from './Ticket'\r\nimport Content from './Content'\r\nimport Popup from '../components/Popup'\r\nimport Toast from '../../../components/Toast'\r\nimport { get, login, goHome, share } from 'utils'\r\nimport 'scss/activity/seckill.component.scss'\r\n\r\nlet prize = ['3天免息券', '2天免息券', '1天免息券']\r\nlet locked = 1\r\nconst appMarket = 'seckill'\r\n\r\nexport default class Seckill extends React.Component {\r\n  constructor (props) {\r\n    super(props)\r\n    this.state = {\r\n      scroll: {\r\n        prize: prize\r\n      },\r\n      code: 0,\r\n      nowTime: '00:00:00',\r\n      actSTime: '',\r\n      actETime: '',\r\n      ticket: []\r\n    }\r\n  }\r\n\r\n  componentWillMount () {\r\n    let ticket = []\r\n    const query = this.props.location.query\r\n    Toast.loading('')\r\n    get(`http://credit.xianjincard.com/activity/spike-act/index?tag=h5-20170425-spikeActivity_act`).then(data => data.data).then(data => {\r\n      Toast.hide()\r\n      this.setState({\r\n        code: data.code,\r\n        actSTime: data.data.act_start_time,\r\n        actETime: data.data.act_end_time\r\n      })\r\n      for (let i in data.data.prizes) {\r\n        ticket.push([data.data.prizes[i]])\r\n      }\r\n      this.setState({\r\n        ticket: ticket,\r\n        nowTime: data.data.cur_time\r\n      })\r\n      if (data.code !== 0) {\r\n        Popup.alert(Content.showHtml(data.code), 'popup')\r\n        Popup.click('a.click')\r\n        return\r\n      }\r\n      if (!data.data.is_login) {\r\n        Popup.alert(Content.showHtml(-1001), 'popup')\r\n        if (query.source_tag) {\r\n          Popup.click('a.click', () => { login(query.source_tag) })\r\n          return\r\n        }\r\n        Popup.click('a.click', () => { login(appMarket) })\r\n        return\r\n      }\r\n    })\r\n  }\r\n\r\n  componentDidMount () {\r\n    document.title = '限时秒杀'\r\n    share('seckill')\r\n  }\r\n\r\n  componentDidUpdate () {\r\n    const lt1 = this.state.nowTime.slice(0, 2) - 14\r\n    const lt2 = this.state.nowTime.slice(0, 2) - 18\r\n\r\n    if (lt2 >= 0 && locked) {\r\n      locked = 0\r\n      setTimeout(() => {\r\n        for (let i = 50; i <= 100; i++) {\r\n          prize = [...prize, ...[`${i}个金币`]]\r\n        }\r\n        this.setState({\r\n          scroll: {\r\n            prize: prize\r\n          }\r\n        })\r\n      }, 6000)\r\n      return\r\n    }\r\n    if (lt1 >= 0 && locked) {\r\n      locked = 0\r\n      setTimeout(() => {\r\n        prize = [...prize, ...['5元抵扣券', '6元抵扣券', '7元抵扣券', '8元抵扣券', '9元抵扣券', '10元抵扣券']]\r\n        this.setState({\r\n          scroll: {\r\n            prize: prize\r\n          }\r\n        })\r\n      }, 6000)\r\n      return\r\n    }\r\n  }\r\n\r\n  rob (type) {\r\n    Toast.loading('')\r\n    get(`http://credit.xianjincard.com/activity/spike-act/get-prize?type=${type}`).then(data => data.data).then(data => {\r\n      Toast.hide()\r\n      if (data.code === -2025) {\r\n        Popup.alert(Content.showHtml(data.code, data.data.type, data.data.text_amount, data.data.name, data.data.expire, data.data.unit), 'popup')\r\n        if (data.data.type === '1') {\r\n          Popup.click('a.click', goHome)\r\n          return\r\n        }\r\n        Popup.click('a.click')\r\n        return\r\n      }\r\n      if (data.code !== 0 && data.code !== -2025) {\r\n        Popup.alert(Content.showHtml(data.code), 'popup')\r\n        if (data.code === -1001) {\r\n          Popup.click('a.click', () => { login(appMarket) })\r\n          return\r\n        }\r\n        Popup.click('a.click')\r\n        return\r\n      }\r\n      let ticket = this.state.ticket\r\n      ticket[type - 1][0].amount = data.data.left\r\n      this.setState({\r\n        ticket: ticket\r\n      })\r\n      Popup.alert(Content.showHtml(data.code, data.data.type, data.data.text_amount, data.data.name, data.data.expire, data.data.unit), 'popup')\r\n      if (data.data.type === '1') {\r\n        Popup.click('a.click', goHome)\r\n        return\r\n      }\r\n      Popup.click('a.click')\r\n    })\r\n  }\r\n\r\n  render () {\r\n    const { scroll, ticket, nowTime, actSTime, actETime, code } = this.state\r\n\r\n    const tk = ticket.map((v, i) => <Ticket key={i} ticket={v} nowTime={nowTime} code={code} rob={this.rob.bind(this)} />)\r\n\r\n    return (\r\n      <div className='transition-group'>\r\n        <div className='seckill'>\r\n          <Scroll scroll={scroll} />\r\n          {tk}\r\n          <div className='rule'>\r\n            <h3>活动说明</h3>\r\n            <p>一、活动时间：{actSTime}-{actETime}</p>\r\n            <p>二、开抢条件：平台用户，每人每天有一次秒杀机会</p>\r\n            <p>三、奖励发放：券有效期1天；金币可至金币商城兑换丰富礼品，券和金币请至APP中【我的】页面查看</p>\r\n            <p>四、本活动最终解释权归现金卡所有，与Apple.Inc无关</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n"]}