{"version":3,"sources":["src\\js\\pages\\activity\\turntable\\Rotate.js"],"names":["rotateNum","rotateArr","Rotate","props","state","rotate","Turn","lotteryNumber","isLogin","locked","inviteCode","gold","userLogin","isWeixin","alert","noChanceHtml","click","isApp","shareUrl","location","protocol","host","shareImage","setState","loading","then","data","hide","code","popupHtml","limit","errorHtml","prize","type","setTimeout","title","arr","list","parseInt","transform","WebkitTransform","bind","Component"],"mappings":"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","file":"Rotate.js","sourceRoot":"E:/MyStudy/Redux/app_four","sourcesContent":["import React from 'react'\r\nimport Content from './Content'\r\nimport Popup from '../components/Popup'\r\nimport Toast from '../../../components/Toast'\r\nimport { partake, get, platform, forwardApp } from 'utils'\r\nimport 'img/activity/turntable/shareIcon.png'\r\n\r\nlet rotateNum = 1\r\nlet rotateArr = [292.5, 202.5, 157.5, 112.5, 22.5]\r\n\r\nexport default class Rotate extends React.Component {\r\n  constructor (props) {\r\n    super(props)\r\n    this.state = {\r\n      rotate: 0\r\n    }\r\n  }\r\n\r\n  rotate () {\r\n    let { lotteryNumber, isLogin, locked, inviteCode, gold } = this.props.Turn.state\r\n    if (!isLogin) {\r\n      this.props.Turn.userLogin('1')\r\n      return\r\n    }\r\n    if (locked) {\r\n      if (!lotteryNumber) {\r\n        if (platform.isWeixin) {\r\n          Popup.alert(Content.noChanceHtml(1), 'popup')\r\n        } else {\r\n          Popup.alert(Content.noChanceHtml(0), 'popup')\r\n        }\r\n        Popup.click('a.click', () => {\r\n          if (platform.isApp) {\r\n            const shareUrl = `${location.protocol}//${location.host}/activity/turntable?invite_code=${inviteCode}`\r\n            const shareImage = `${location.protocol}//${location.host}/assets/img/activity/turntable/shareIcon.png`\r\n            partake({\r\n              'share_title': '借款免息，还送iPhone7',\r\n              'share_body': '快来这里，玩转现金卡',\r\n              'share_url': shareUrl,\r\n              'share_logo': shareImage\r\n            })\r\n            return\r\n          }\r\n          if (platform.isWeixin) {\r\n            return\r\n          }\r\n          forwardApp()\r\n        })\r\n        return\r\n      }\r\n      this.props.Turn.setState({\r\n        locked: 0\r\n      })\r\n      Toast.loading('')\r\n      get(`http://credit.xianjincard.com/activity/turntable-act/prize-draw?tag=h5-20170327-turntableAct_act`).then(data => data.data).then(data => {\r\n        Toast.hide()\r\n        if (data.code === -1001) {\r\n          this.props.Turn.userLogin('1')\r\n          return\r\n        }\r\n        if (data.code === -2022) {\r\n          Popup.alert(Content.popupHtml(`<p class=\"middle\"><span>您今天已经抽过${data.data.limit}次了哦~<br />请明天再来吧！</span></p>`), 'popup popup-error')\r\n          this.props.Turn.setState({\r\n            locked: 1\r\n          })\r\n          return\r\n        }\r\n        if (data.code !== 0) {\r\n          Popup.alert(Content.errorHtml(), 'popup popup-error')\r\n          this.props.Turn.setState({\r\n            locked: 1\r\n          })\r\n          return\r\n        }\r\n        this.props.Turn.setState({\r\n          lotteryNumber: --lotteryNumber\r\n        })\r\n        let rotate = []\r\n        switch (data.data.prize.type) {\r\n          case 'deduction_ticket':\r\n            rotate = rotateArr[0]\r\n            break\r\n          case 'temp_credit':\r\n            rotate = rotateArr[1]\r\n            break\r\n          case 'cash_money':\r\n            rotate = rotateArr[2]\r\n            break\r\n          case 'gold_score':\r\n            rotate = rotateArr[3]\r\n            break\r\n          case 'free_ticket':\r\n            rotate = rotateArr[4]\r\n            break\r\n        }\r\n        this.setState({\r\n          rotate: 1440 * rotateNum + rotate\r\n        })\r\n        rotateNum++\r\n        setTimeout(() => {\r\n          Popup.alert(Content.popupHtml(`<p class='middle'><span>亲，恭喜您抽中<b>${data.data.prize.title}</b>!<br />请去APP中<b>【我的】</b>查看哦！</span></p>`), 'popup popup-error')\r\n          this.props.Turn.setState({\r\n            locked: 1,\r\n            arr: data.data.list\r\n          })\r\n          if (data.data.prize.type === 'gold_score') {\r\n            this.props.Turn.setState({\r\n              gold: parseInt(data.data.prize.title) + gold\r\n            })\r\n          }\r\n        }, 4000)\r\n      })\r\n    }\r\n  }\r\n\r\n  render () {\r\n    const { rotate } = this.state\r\n\r\n    return (\r\n      <div className='rotate-div'>\r\n        <div className='rotate' style={{transform: `rotate(${rotate}deg)`, WebkitTransform: `rotate(${rotate}deg)`}} />\r\n        <div className='pointer' onClick={this.rotate.bind(this)} />\r\n      </div>\r\n    )\r\n  }\r\n}\r\n"]}