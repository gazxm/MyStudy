'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _promise = require('babel-runtime/core-js/promise');

var _promise2 = _interopRequireDefault(_promise);

var _axios = require('axios');

var _axios2 = _interopRequireDefault(_axios);

var _utils = require('utils');

function _interopRequireDefault(obj) {
    return obj && obj.__esModule ? obj : { default: obj };
}

var request = _axios2.default.create(); /* eslint-disable */

request.interceptors.request.use(function (config) {
    config.timeout = 10000;
    config.url = /^(https?|\/\/)/.test(config.url) ? /m\.xianjincard\.com/.test(config.url) ? (0, _utils.resolveUrl)(config.url) : config.url : (0, _utils.resolveUrl)('http://credit.xianjincard.com/' + config.url.replace(/^\//, ''));

    if (config.method && config.method.toUpperCase() === 'POST') {
        config.headers['Content-Type'] = 'application/x-www-form-urlencoded';
        if (config.data && config.data.toString() === '[object Object]') {
            var data = new FormData();
            for (var i in config.data) {
                data.append(i, config.data[i]);
            }
            config.data = data;
        }
    }
    return config;
}, function (error) {
    return _promise2.default.reject(error);
});

request.interceptors.response.use(function (response) {
    return _promise2.default.resolve(response.data || {});
}, function (error) {
    error && /timeout/.test(error.message) && (error.message = '请求超时，请稍后重试');
    return _promise2.default.reject(error);
});

exports.default = request;
module.exports = exports['default'];