{"version":3,"sources":["src\\js\\components\\Password.js"],"names":["focusHandler","e","dom","popup","querySelector","interval","setInterval","document","activeElement","nodeName","style","top","webkitTransform","body","scrollTop","clearInterval","inputHandler","input","els","map","v","className","slice","value","length","callback","errorDom","display","close","preventDefault","html","title","createElement","innerHTML","appendChild","addEventListener","stopPropagation","focus","i","querySelectorAll","Array","prototype","call","msg","reset","createDom","parentNode","removeChild"],"mappings":";;;;;;;;;;;;;;AAAA;;AACA;;;;;;mCAEe;sBAAA;gBAAA;;wCAAA;;SAAA,AA0Cb,eAAe,UAAA,AAAC,GAAM,AACpB;UAAI,MAAM,MAAA,AAAK,MAAL,AAAW,cAArB,AAAU,AAAyB,AACnC;UAAI,uBAAuB,YAAY,AACrC;YAAI,SAAA,AAAS,cAAT,AAAuB,aAA3B,AAAwC,SAAS,AAC/C;cAAA,AAAI,MAAJ,AAAU,MAAV,AAAgB,AAChB;cAAA,AAAI,MAAJ,AAAU,kBAAV,AAA4B,AAC5B;mBAAA,AAAS,KAAT,AAAc,YAAd,AAA0B,AAC3B;AAJD,eAIO,AACL;cAAA,AAAI,MAAJ,AAAU,MAAV,AAAgB,AAChB;cAAA,AAAI,MAAJ,AAAU,kBAAV,AAA4B,AAC5B;cAAA,AAAI,UAAU,AACZ;0BAAA,AAAc,AACd;uBAAA,AAAW,AACZ;AACF;AACF;AAbc,OAAA,EAAf,AAAe,AAaZ,AACJ;AA1DY;;SAAA,AA4Db,eAAe,UAAA,AAAC,GAAD,AAAI,OAAJ,AAAW,KAAQ,AAChC;UAAA,AAAI,IAAI,UAAA,AAAU,GAAG,AAAE;UAAA,AAAE,YAAF,AAAc,AAAI;AAAzC,AACA;UAAA,AAAI,MAAJ,AAAU,GAAG,MAAA,AAAM,MAAnB,AAAyB,QAAzB,AAAiC,IAAI,UAAA,AAAU,GAAG,AAChD;UAAA,AAAE,YAAF,AAAc,AACf;AAFD,AAGA;UAAI,MAAA,AAAM,MAAN,AAAY,UAAhB,AAA0B,GAAG,AAC3B;cAAA,AAAM,QAAQ,MAAA,AAAM,MAAN,AAAY,MAAZ,AAAkB,GAAhC,AAAc,AAAqB,AACnC;cAAA,AAAK,YAAY,MAAA,AAAK,SAAS,MAA/B,AAAiB,AAAoB,AACtC;AAED;;UAAI,MAAA,AAAM,MAAN,AAAY,SAAhB,AAAyB,GAAG,AAC1B;cAAA,AAAK,SAAL,AAAc,MAAd,AAAoB,UAApB,AAA8B,AAC/B;AACF;AAzEY;;SAAA,AAgFb,QAAQ,UAAA,AAAC,GAAM,AACb;QAAA,AAAE,AACF;YAAA,AAAK,MAAL,AAAW,MAAX,AAAiB,UAAjB,AAA2B,AAC5B;AAnFY;AAAA;;;SAAA;gCACA,AACX;UAAI,kJAGgB,KAHhB,AAGqB,QAHzB,AAWA;UAAI,QAAQ,SAAA,AAAS,cAArB,AAAY,AAAuB,AACnC;YAAA,AAAM,YAAN,AAAkB,AAClB;YAAA,AAAM,YAAN,AAAkB,AAClB;eAAA,AAAS,KAAT,AAAc,YAAd,AAA0B,AAE1B;;WAAA,AAAK,WAAW,MAAA,AAAM,cAAtB,AAAgB,AAAoB,AACpC;WAAA,AAAK,QAAL,AAAa,AAEb;;YAAA,AAAM,cAAN,AAAoB,YAApB,AAAgC,iBAAhC,AAAiD,SAAS,UAAA,AAAU,GAAG,AACrE;UAAA,AAAE,AACH;AAFD,SAAA,AAEG,AAEH;;YAAA,AAAM,cAAN,AAAoB,KAApB,AAAyB,iBAAzB,AAA0C,SAAS,UAAA,AAAU,GAAG,AAC9D;UAAA,AAAE,AACF;mBACD;AAHD,SAAA,AAGG,AACH;YAAA,AAAM,cAAN,AAAoB,cAApB,AAAkC,iBAAlC,AAAmD,SAAS,KAA5D,AAAiE,OAAjE,AAAwE,AACxE;YAAA,AAAM,cAAN,AAAoB,cAApB,AAAkC,iBAAlC,AAAmD,SAAS,UAAA,AAAC,GAAM,AACjE;cAAA,AAAM,AACP;AAFD,SAAA,AAEG,AAEH;;UAAM,QAAQ,MAAA,AAAM,cAApB,AAAc,AAAoB,AAClC;UAAM,IAAI,MAAA,AAAM,iBAAhB,AAAU,AAAuB,AACjC;UAAM,MAAM,MAAA,AAAM,UAAN,AAAgB,MAAhB,AAAsB,KAAtB,AAA2B,GAAvC,AAAY,AAA8B,AAC1C;UAAM,eAAe,KAArB,AAA0B,AAC1B;YAAA,AAAM,iBAAN,AAAuB,SAAS,UAAA,AAAU,GAAG,AAAE;qBAAA,AAAa,GAAb,AAAgB,MAAhB,AAAsB,AAAM;AAA3E,SAAA,AAA6E,AAC7E;YAAA,AAAM,iBAAN,AAAuB,SAAS,KAAhC,AAAqC,cAArC,AAAmD,AACpD;AAxCY;AAAA;SAAA;4BA2EQ;UAAd,AAAc,0EAAR,AAAQ,AACnB;;WAAA,AAAK,SAAL,AAAc,MAAd,AAAoB,UAApB,AAA8B,AAC9B;WAAA,AAAK,SAAL,AAAc,YAAd,AAA0B,AAC3B;AA9EY;AAAA;SAAA;0BAAA,AAqFN,KAAK,AACV;UAAM,IAAI,IAAA,AAAI,iBAAd,AAAU,AAAqB,AAC/B;UAAM,MAAM,MAAA,AAAM,UAAN,AAAgB,MAAhB,AAAsB,KAAtB,AAA2B,GAAvC,AAAY,AAA8B,AAC1C;UAAM,QAAQ,IAAA,AAAI,cAAlB,AAAc,AAAkB,AAChC;WAAA,AAAK,SAAL,AAAc,MAAd,AAAoB,UAApB,AAA8B,AAC9B;UAAA,AAAI,IAAI,UAAA,AAAU,GAAG,AAAE;UAAA,AAAE,YAAF,AAAc,AAAI;AAAzC,AACA;YAAA,AAAM,QAAN,AAAc,AACd;YAAA,AAAM,AACP;AA7FY;AAAA;SAAA;yBAAA,AA+FP,UAA6B;UAAnB,AAAmB,4EAAX,AAAW,AACjC;;WAAA,AAAK,WAAL,AAAgB,AAChB;WAAA,AAAK,QAAL,AAAa,AACb;UAAI,QAAQ,SAAA,AAAS,cAArB,AAAY,AAAuB,AACnC;UAAI,UAAJ,AAAc,MAAM,AAClB;cAAA,AAAM,MAAN,AAAY,UAAZ,AAAsB,AACtB;cAAA,AAAM,cAAN,AAAoB,MAApB,AAA0B,YAA1B,AAAsC,AACtC;aAAA,AAAK,MAAL,AAAW,AACX;AACD;AACD;WAAA,AAAK,AACN;AA1GY;AAAA;SAAA;6BA4GH,AACR;UAAI,QAAQ,SAAA,AAAS,cAArB,AAAY,AAAuB,AACnC;UAAI,UAAJ,AAAc,MAAM,AAClB;cAAA,AAAM,WAAN,AAAiB,YAAjB,AAA6B,AAC9B;AACF;AAjHY;AAAA;SAAA;A,GAAA","file":"Password.js","sourceRoot":"E:/MyStudy/Redux/app_four","sourcesContent":["import { retrievePassword } from 'utils'\r\nimport 'scss/components/password.component.scss'\r\n\r\nexport default new class Password {\r\n  createDom () {\r\n    let html = `<div class=\"overlay\"></div>\\\r\n                <div class=\"dialog pay\">\\\r\n                  <span class=\"close\"></span>\\\r\n                  <h2>${this.title}</h2>\\\r\n                  <p class=\"clearfix\">\\\r\n                    <i></i> <i></i> <i></i> <i></i> <i></i> <i></i>\\\r\n                    <input type=\"tel\" value=\"\" autofocus>\\\r\n                  </p>\\\r\n                  <p class=\"error-tips\">密码错误</p>\\\r\n                  <a href=\"\">忘记密码?</a>\\\r\n                </div>`\r\n    let popup = document.createElement('div')\r\n    popup.className = 'popup-password'\r\n    popup.innerHTML = html\r\n    document.body.appendChild(popup)\r\n\r\n    this.errorDom = popup.querySelector('p.error-tips')\r\n    this.popup = popup\r\n\r\n    popup.querySelector('.overlay').addEventListener('click', function (e) {\r\n      e.stopPropagation()\r\n    }, false)\r\n\r\n    popup.querySelector('a').addEventListener('click', function (e) {\r\n      e.preventDefault()\r\n      retrievePassword()\r\n    }, false)\r\n    popup.querySelector('span.close').addEventListener('click', this.close, false)\r\n    popup.querySelector('p.clearfix').addEventListener('click', (e) => {\r\n      input.focus()\r\n    }, false)\r\n\r\n    const input = popup.querySelector('input')\r\n    const i = popup.querySelectorAll('i')\r\n    const els = Array.prototype.slice.call(i, '')\r\n    const inputHandler = this.inputHandler\r\n    input.addEventListener('input', function (e) { inputHandler(e, this, els) }, false)\r\n    input.addEventListener('focus', this.focusHandler, false)\r\n  }\r\n\r\n  focusHandler = (e) => {\r\n    let dom = this.popup.querySelector('.dialog')\r\n    let interval = setInterval(function () {\r\n      if (document.activeElement.nodeName === 'INPUT') {\r\n        dom.style.top = '0'\r\n        dom.style.webkitTransform = 'translate(-50%, 0)'\r\n        document.body.scrollTop = 0\r\n      } else {\r\n        dom.style.top = '50%'\r\n        dom.style.webkitTransform = 'translate(-50%, -50%)'\r\n        if (interval) {\r\n          clearInterval(interval)\r\n          interval = null\r\n        }\r\n      }\r\n    }, 300)\r\n  }\r\n\r\n  inputHandler = (e, input, els) => {\r\n    els.map(function (v) { v.className = '' })\r\n    els.slice(0, input.value.length).map(function (v) {\r\n      v.className = 'point'\r\n    })\r\n    if (input.value.length >= 6) {\r\n      input.value = input.value.slice(0, 6)\r\n      this.callback && this.callback(input.value)\r\n    }\r\n\r\n    if (input.value.length < 6) {\r\n      this.errorDom.style.display = 'none'\r\n    }\r\n  }\r\n\r\n  error (msg = '密码错误') {\r\n    this.errorDom.style.display = 'block'\r\n    this.errorDom.innerHTML = msg\r\n  }\r\n\r\n  close = (e) => {\r\n    e.preventDefault()\r\n    this.popup.style.display = 'none'\r\n  }\r\n\r\n  reset (dom) {\r\n    const i = dom.querySelectorAll('i')\r\n    const els = Array.prototype.slice.call(i, '')\r\n    const input = dom.querySelector('input')\r\n    this.errorDom.style.display = 'none'\r\n    els.map(function (v) { v.className = '' })\r\n    input.value = ''\r\n    input.focus()\r\n  }\r\n\r\n  show (callback, title = '请输入交易密码') {\r\n    this.callback = callback\r\n    this.title = title\r\n    let popup = document.querySelector('.popup-password')\r\n    if (popup !== null) {\r\n      popup.style.display = 'block'\r\n      popup.querySelector('h2').innerHTML = title\r\n      this.reset(popup)\r\n      return\r\n    }\r\n    this.createDom()\r\n  }\r\n\r\n  remove () {\r\n    let popup = document.querySelector('.popup-password')\r\n    if (popup !== null) {\r\n      popup.parentNode.removeChild(popup)\r\n    }\r\n  }\r\n}()\r\n"]}